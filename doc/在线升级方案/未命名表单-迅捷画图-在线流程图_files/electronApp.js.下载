

try{
    window.fs = require("fs");
    window.electron = require("electron");
    window.electron_ipcRenderer = electron.ipcRenderer;
    window.electron_remote = electron.remote;
    window.electron_browserWindow = electron_remote.BrowserWindow;
    window.electron_current_window_id = electron_remote.getCurrentWindow().id;  //当前窗口ID

    window.electron_open_local_file_path = electron_remote.process.argv[1] || ""; //程序启动时的命令行参数：主窗口的文件路径。
    window.electron_windows_file_path = [];  //所有窗口的文件路径
    electron_remote.process.argv[1] = '';
    const pathArry = electron_open_local_file_path.split(".");
    window.electron_shell = electron.shell;
    // window.localCookiePath = __dirname+"/../../cookiefile.json";
    var os = require('os')
    var userInfo = os.userInfo();
    var dirPath = userInfo.homedir.split("\\");
    window.localCookiePath = "";
    window.statisticsPath = "";
    if(os.platform() == 'win32'){
        window.currentPlatform = 'electron-win';
        for(var i=0;i<dirPath.length; i++){
            window.localCookiePath = window.localCookiePath + dirPath[i] +"\\";
            window.statisticsPath = window.statisticsPath + dirPath[i] +"\\";
        }
    }else{
        for(var i=0;i<dirPath.length; i++){
            window.localCookiePath = window.localCookiePath + dirPath[i] +"\/";
            window.statisticsPath = window.statisticsPath + dirPath[i] +"\/";
        }
    }
    if(os.platform() == "darwin"){
        window.currentPlatform = 'mac'
    };
    window.statisticsPath = window.statisticsPath + "statistics.json";
    window.localCookiePath = window.localCookiePath + "cookiefile.json";
    fs.exists(localCookiePath,function(exists){
        if(!exists){
            fs.writeFile(localCookiePath,'', 'utf-8', function(error, success){
                if(error){
                    console.log("创建失败");
                }else{
                    console.log("创建成功");
                }
            });
        }
    });
    fs.exists(statisticsPath,function(exists){
        if(!exists){
            fs.writeFile(statisticsPath,'', 'utf-8', function(error, success){
                if(error){
                    console.log("创建失败");
                }else{
                    console.log("创建成功");
                }
            });
        }
    });
    // const {shell} = require('electron');

    //如果当前打开的是主窗口，并且打开文件格式为‘xjm’
    // if( electron_current_window_id=="1" && pathArry && pathArry[pathArry.length-1] && pathArry[pathArry.length-1]=='xjm'){
    //     electron_windows_file_path[electron_current_window_id] = electron_open_local_file_path;
    // }
    document.title = '迅捷流程图—办公高手都在用的脑图软件';
}catch(error) {
    console.log(error);
}



